% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{adjust_influence}
\alias{adjust_influence}
\title{Calculate adjusted influence scores}
\usage{
adjust_influence(influence_df, const = -24, signif = 6)
}
\arguments{
\item{influence_df}{Data frame, as returned by \code{calculate_influence}. If a 'target'
column is present, influence scores will be grouped and averaged by target.}

\item{const}{Constant value added to log(influence) to ensure non-negative adjusted
influence scores. Default -24 was chosen so all well-connected neurons have
adjusted_influence >= 0.}

\item{signif}{Number of significant figures for output values.}
}
\value{
Data frame with adjusted influence columns:
\describe{
\item{adjusted_influence}{log(summed_influence) + const - basic adjusted influence}
\item{adjusted_influence_norm_by_targets}{Normalized by number of target neurons: log(summed_influence/n_targets) + const}
\item{adjusted_influence_norm_by_sources_and_targets}{Normalized by both source and target counts: log(summed_influence/(n_sources * n_targets)) + const}
}
}
\description{
Computes adjusted influence scores by taking the natural logarithm of steady-state
neural activity and adding a constant to bring values into the non-negative range.
The adjusted influence is defined as: adjusted_influence = log(r) + c, where r is
the steady-state response and c is a constant. Poorly connected neurons with
log(r) << c are set to 0.
}
\details{
When a 'target' column is present, influence scores are averaged within each target
group, allowing analysis of influence on cell types or anatomical regions rather
than individual neurons.
}
\examples{
\dontrun{
# Basic adjusted influence calculation
ic <- influence_calculator_r(edgelist_simple = edges.table, meta = meta)
influence_scores <- ic$calculate_influence(seed_ids) 
adjusted_scores <- adjust_influence(influence_scores)
head(adjusted_scores)

# Group targets by cell type and calculate averaged influence
# This averages influence within each target group
influence_by_celltype <- influence_scores \%>\%
  dplyr::left_join(meta \%>\%
                     dplyr::select(root_id, target = cell_type),
                   by = c("id" = "root_id")) \%>\% 
  adjust_influence()
head(influence_by_celltype)

# Group targets by brain region
influence_by_region <- influence_scores \%>\%
  dplyr::left_join(meta \%>\%
                     dplyr::select(root_id, target = brain_region),
                   by = c("id" = "root_id")) \%>\% 
  adjust_influence()
}
}
